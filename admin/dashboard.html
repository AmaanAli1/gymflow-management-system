<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ============================================
         CHARACTER ENCODING & VIEWPORT
         ============================================ -->
    <!-- UTF-8: Supports all characters (emojis, special symbols, international text) -->
    <meta charset="UTF-8">
    
    <!-- Viewport: Makes site responsive on mobile devices
         - width=device-width: Use device's width (not zoomed out desktop view)
         - initial-scale=1.0: Don't zoom in/out by default -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Page title (shows in browser tab) -->
    <title>GymFlow Admin | Dashboard</title>

    <!-- ============================================
         EXTERNAL RESOURCES
         ============================================ -->
    <!-- Google Fonts: Montserrat (headings) & Poppins (body text) -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Font Awesome: Icon library for UI icons -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
          crossorigin="anonymous" 
          referrerpolicy="no-referrer">

    <!-- ============================================
         CUSTOM STYLESHEETS (Order matters!)
         ============================================ -->
    <!-- 1. Variables first (colors, fonts, spacing used by other files) -->
    <link rel="stylesheet" href="../css/variables.css">
    
    <!-- 2. Base styles (resets, body, common elements) -->
    <link rel="stylesheet" href="../css/base.css">
    
    <!-- 3. Layout (sidebar, topbar, main-content structure) -->
    <link rel="stylesheet" href="../css/layout.css">
    
    <!-- 4. Reusable components (used across multiple pages) -->
    <link rel="stylesheet" href="../css/components/buttons.css">
    <link rel="stylesheet" href="../css/components/cards.css">
    <link rel="stylesheet" href="../css/components/modals.css">
    
    <!-- 5. Page-specific styles (only for this dashboard) -->
    <link rel="stylesheet" href="../css/pages/admin-dashboard.css">
</head>

<body>

    <!-- ============================================ 
         DEMO MODE BANNER
         Visible on all pages
         ============================================ -->

    <div class="demo-banner" id="demoBanner">
        <div class="demo-banner-content">
            <i class="fa-solid fa-info-circle"></i>
            <div class="demo-banner-text">
                <strong>Demo Mode:</strong>
                Feel free to explore and modify data! The database automatically resets daily at 3:00 AM EST.
                <span id="nextReset"></span>
            </div>
            <button class="demo-banner-close" onclick="dismissDemoBanner()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
    </div>

    <!-- ============================================
         SIDEBAR NAVIGATION
         Role: Main navigation menu for admin
         ============================================ -->
    <aside class="sidebar" role="navigation" aria-label="Main navigation">
        
        <!-- Sidebar Header: Logo & Pin Button -->
        <div class="sidebar-header">
            <!-- Logo icon (visible when collapsed) -->
            <div class="sidebar-logo-icon" aria-hidden="true">GF</div>
            
            <!-- Logo text (visible when expanded) -->
            <div class="sidebar-logo-text">GymFlow</div>

            <!-- Pin button: Keeps sidebar expanded when clicked -->
            <button class="sidebar-pin-btn" 
                    id="sidebarPinBtn" 
                    aria-label="Pin or unpin sidebar"
                    title="Pin / Unpin sidebar">
                <i class="fa-solid fa-thumbtack" aria-hidden="true"></i>
            </button>
        </div>

        <!-- Navigation Links -->
        <nav class="sidebar-nav">
            <!-- Dashboard (current page) -->
            <a href="./dashboard.html" class="nav-item active" aria-current="page">
                <i class="fa-solid fa-house" aria-hidden="true"></i>
                <span>Dashboard</span>
            </a>

            <!-- Members Section (has submenu) -->
            <div class="nav-group">
                <button class="nav-item has-sub" aria-expanded="false">
                    <i class="fa-solid fa-users" aria-hidden="true"></i>
                    <span>Members</span>
                    <i class="fa-solid fa-chevron-down caret" aria-hidden="true"></i>
                </button>
                <div class="submenu">
                    <a href="./members.html" class="submenu-item">All Members</a>
                    <a href="#" 
                       class="submenu-item open-modal" 
                       data-modal="add-member-modal">
                        Add Member
                    </a>
                    <a href="#" 
                       class="submenu-item open-modal" 
                       data-modal="checkin-modal">
                        Member Check-In
                    </a>
                </div>
            </div>

            <!-- Staff Section (has submenu) -->
            <div class="nav-group">
                <button class="nav-item has-sub" aria-expanded="false">
                    <i class="fa-solid fa-user-gear" aria-hidden="true"></i>
                    <span>Staff</span>
                    <i class="fa-solid fa-chevron-down caret" aria-hidden="true"></i>
                </button>
                <div class="submenu">
                    <a href="./staff.html" class="submenu-item">All Staff</a>
                    <a href="#" 
                       class="submenu-item open-modal" 
                       data-modal="add-staff-modal">
                        Add Staff
                    </a>
                    <a href="#" 
                       class="submenu-item open-modal" 
                       data-modal="add-trainer-modal">
                        Add Trainer
                    </a>
                </div>
            </div>

            <!-- Inventory Section (has submenu) -->
            <div class="nav-group">
                <button class="nav-item has-sub" aria-expanded="false">
                    <i class="fa-solid fa-box" aria-hidden="true"></i>
                    <span>Inventory</span>
                    <i class="fa-solid fa-chevron-down caret" aria-hidden="true"></i>
                </button>
                <div class="submenu">
                    <a href="./inventory.html" class="submenu-item">Stock Overview</a>
                    <a href="./inventory-reorders.html" class="submenu-item">Reorder Requests</a>
                    <a href="./inventory-vendors.html" class="submenu-item">Vendors</a>
                </div>
            </div>

            <!-- Locations Section -->
            <a href="./locations.html" class="nav-item">
                <i class="fa-solid fa-location-dot" aria-hidden="true"></i>
                <span>Locations</span>
            </a>

            <!-- Settings Section -->
            <a href="./settings.html" class="nav-item">
                <i class="fa-solid fa-gear" aria-hidden="true"></i>
                <span>Settings</span>
            </a>
        </nav>

        <!-- Sidebar Footer: Profile & Logout -->
        <div class="sidebar-footer">
            <div class="profile">
                <img src="https://i.pravatar.cc/40" 
                     alt="Admin profile picture" 
                     loading="lazy">
                <span class="profile-name">Admin</span>
            </div>
            <button class="logout-btn" aria-label="Logout">
                <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i>
                <span>Logout</span>
            </button>
        </div>
    </aside>

    <!-- ============================================
         MAIN CONTENT AREA
         Contains: Topbar + Dashboard content
         ============================================ -->
    <div class="main-content">
        
        <!-- Topbar: Page title + Actions -->
        <header class="topbar">
            <h1>Dashboard</h1>
            <div class="topbar-actions">
                <!-- Notification button -->
                <button class="notification-btn" aria-label="View notifications">
                    <i class="fa-regular fa-bell" aria-hidden="true"></i>
                </button>
                
                <!-- Profile picture -->
                <img src="https://i.pravatar.cc/35" 
                     alt="Admin profile picture" 
                     class="topbar-profile"
                     loading="lazy">
            </div>
        </header>

        <!-- ============================================
             DASHBOARD CONTENT
             ============================================ -->
        <section class="dashboard-overview">
            
            <!-- KPI Cards: Key Performance Indicators -->
            <div class="kpi-grid">
                
                <!-- Total Members KPI -->
                <article class="kpi-card">
                    <p class="kpi-label">Total Members</p>
                    <p class="kpi-value" data-metric="totalMembers">---</p>
                </article>

                <!-- Monthly Revenue KPI -->
                <article class="kpi-card">
                    <p class="kpi-label">Monthly Revenue</p>
                    <p class="kpi-value" data-metric="monthlyRevenue">---</p>
                </article>

                <!-- Inventory Health KPI -->
                <article class="kpi-card">
                    <p class="kpi-label">Inventory Health</p>
                    <p class="kpi-value" data-metric="inventoryHealth">---</p>
                </article>

                <!-- Active Trainers KPI -->
                <article class="kpi-card">
                    <p class="kpi-label">Active Trainers</p>
                    <p class="kpi-value" data-metric="activeTrainers">---</p>
                </article>
            </div>

            <!-- Two-column layout: Branch Performance + Recent Activity -->
            <div class="dash-grid">
                
                <!-- Branch Performance Panel -->
                <article class="panel">
                    <div class="panel-header">
                        <h2>Branch Performance Snapshot</h2>
                        <span class="panel-tag live">
                            <span class="live-dot"></span>
                            Live Signal
                        </span>
                    </div>
                    <div class="panel-body">
                        <!-- Branch cards will be populated by JavaScript -->
                        <div id="branchCards">
                            <!-- JavaScript will insert branch cards here -->
                        </div>
                    </div>
                </article>

                <!-- Recent Activity Panel -->
                <article class="panel">
                    <div class="panel-header">
                        <h2>Recent Activity</h2>
                    </div>
                    <div class="panel-body">
                        <!-- Activity feed will be populated by JavaScript -->
                        <div id="activityFeed">
                            <!-- JavaScript will insert activity items here -->
                        </div>
                    </div>
                </article>
            </div>

            <!-- ============================================
                 CHARTS SECTION
                 Membership Growth + Revenue by Location
                 ============================================ -->
            <div class="charts-grid">
                <article class="panel">
                    <div class="panel-header">
                        <h2>Membership Growth (Last 6 Months)</h2>
                        <span class="panel-tag">Live Data</span>
                    </div>
                    <div class="panel-body">
                        <!-- Chart.js canvas -->
                        <canvas id="membershipChart"></canvas>
                    </div>
                </article>

                <article class="panel">
                    <div class="panel-header">
                        <h2>Monthly Revenue by Location</h2>
                        <span class="panel-tag">Live Data</span>
                    </div>
                    <div class="panel-body">
                        <!-- Chart.js canvas -->
                        <canvas id="revenueChart"></canvas>
                    </div>
                </article>
            </div>

            <!-- ============================================
                 BOTTOM PANELS
                 Inventory Alerts + System Health
                 ============================================ -->
            <div class="bottom-panels">
                <article class="panel">
                    <div class="panel-header">
                        <h2>Inventory & Supply Alerts</h2>
                        <span class="panel-tag warn">Attention Needed</span>
                    </div>
                    <div class="panel-body">
                        <!-- Alerts will be populated by JavaScript -->
                        <ul id="inventoryAlerts" class="alert-list">
                            <!-- JavaScript will insert alerts here -->
                        </ul>
                    </div>
                </article>

                <article class="panel">
                    <div class="panel-header">
                        <h2>System Health</h2>
                        <span class="panel-tag">Status</span>
                    </div>
                    <div class="panel-body">
                        <!-- System status will be populated by JavaScript -->
                        <ul id="systemHealth" class="health-list">
                            <!-- JavaScript will insert status here -->
                        </ul>
                    </div>
                </article>
            </div>
        </section>
    </div>

    <!-- ============================================
         MODALS (Hidden by default, shown when triggered)
         ============================================ -->

    <!-- Add Member Modal -->
    <div class="modal-overlay" id="add-member-modal" aria-hidden="true">
        <div class="modal-card">
            <div class="modal-header">
                <h2>Add New Member</h2>
                <button class="modal-close" data-close-modal aria-label="Close modal">&times;</button>
            </div>

            <form id="addMemberForm">
                <div class="modal-body">
                    <div class="modal-grid">
                        <div class="field">
                            <label for="memberName">Full Name *</label>
                            <input type="text" id="memberName" name="name" required placeholder="John Doe">
                        </div>
                        <div class="field">
                            <label for="memberEmail">Email *</label>
                            <input type="email" id="memberEmail" name="email" required placeholder="john@example.com">
                        </div>
                        <div class="field">
                            <label for="memberPhone">Phone *</label>
                            <input type="tel" id="memberPhone" name="phone" placeholder="(555) 123-4567" required>
                        </div>
                        <div class="field">
                            <label for="memberEmergencyContact">Emergency Contact</label>
                            <input type="tel" id="memberEmergencyContact" name="emergency_contact" placeholder="(555) 987-6543">
                        </div>
                        <div class="field">
                            <label for="memberLocation">Location *</label>
                            <select id="memberLocation" name="location_id" required>
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>
                        <div class="field">
                            <label for="memberPlan">Membership Plan *</label>
                            <select id="memberPlan" name="plan" required>
                                <option value="Basic">Basic</option>
                                <option value="Premium">Premium</option>
                                <option value="Elite">Elite</option>
                            </select>
                        </div>
                    </div>
                    <div class="field">
                        <label for="memberNotes">Notes (Optional)</label>
                        <textarea id="memberNotes" name="notes" rows="3" placeholder="Goals, referral source, special requests..."></textarea>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn ghost" data-close-modal>Cancel</button>
                    <button type="submit" class="btn primary">Save Member</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Member Check-In Modal -->
    <div class="modal-overlay" id="checkin-modal" aria-hidden="true">
        <div class="modal-card">
            <div class="modal-header">
                <h2>Member Check-In</h2>
                <button class="modal-close" data-close-modal aria-label="Close modal">&times;</button>
            </div>

            <form id="checkinForm">
                <div class="modal-body">
                    <div class="field">
                        <label for="checkinSearch">Search Member</label>
                        <input type="text" id="checkinSearch" placeholder="Type name, email, or member ID">
                        <!-- Hidden field to store selected member ID -->
                        <input type="hidden" id="checkInMemberId" name="member_id">
                        <!-- Hidden field to store member's home location -->
                        <input type="hidden" id="checkInMemberLocationId">
                    </div>
                    <div class="field">
                        <label for="checkinLocation">Location</label>
                        <select id="checkinLocation" name="location_id">
                        <!-- Options populated by JavaScript -->
                        </select>
                        <!-- Warning message (hidden by default) -->
                        <div id="locationWarning" class="field-warning" style="display: none;">
                            <i class="fa-solid fa-exclamation-triangle"></i>
                            <span>This is not the member's home location</span>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn ghost" data-close-modal>Close</button>
                    <button type="submit" class="btn primary" id="confirmCheckInBtn">Confirm Check-In</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Trainer Modal -->
    <div class="modal-overlay" id="add-trainer-modal" role="dialog" aria-labelledby="addTrainerTitle" aria-hidden="true">
        <div class="modal-card">
            <div class="modal-header">
                <h2 id="addTrainerTitle">Add Trainer</h2>
                <button class="modal-close" data-close-modal aria-label="Close modal">&times;</button>
            </div>

            <div class="modal-body">
                <form id="addTrainerForm">
                    <div class="modal-grid">
                        <div class="field">
                            <label for="trainerName">Full Name</label>
                            <input type="text" 
                                   id="trainerName" 
                                   name="name"
                                   placeholder="Jane Doe" 
                                   required>
                        </div>
                        <div class="field">
                            <label for="trainerEmail">Email</label>
                            <input type="email" 
                                   id="trainerEmail" 
                                   name="email"
                                   placeholder="jane@gymflow.com" 
                                   required>
                        </div>
                        <div class="field">
                            <label for="trainerLocation">Location</label>
                            <select id="trainerLocation" name="location" required>
                                <option value="">Select location</option>
                                <option value="downtown">Downtown</option>
                                <option value="midtown">Midtown</option>
                                <option value="eastside">Eastside</option>
                            </select>
                        </div>
                        <div class="field">
                            <label for="trainerSpecialty">Specialty</label>
                            <select id="trainerSpecialty" name="specialty" required>
                                <option value="">Select specialty</option>
                                <option value="strength">Strength</option>
                                <option value="hypertrophy">Hypertrophy</option>
                                <option value="weightloss">Weight Loss</option>
                                <option value="conditioning">Conditioning</option>
                                <option value="yoga">Yoga / Mobility</option>
                            </select>
                        </div>
                        <div class="field">
                            <label for="trainerRate">Hourly Rate</label>
                            <input type="number" 
                                   id="trainerRate" 
                                   name="rate"
                                   placeholder="e.g. 65" 
                                   min="0" 
                                   step="5">
                        </div>
                    </div>
                    <div class="field">
                        <label for="trainerNotes">Notes</label>
                        <textarea id="trainerNotes" 
                                  name="notes"
                                  rows="3" 
                                  placeholder="Certifications, preferences, languages..."></textarea>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button class="btn ghost" data-close-modal type="button">Cancel</button>
                <button class="btn primary" type="submit" form="addTrainerForm">Save Trainer</button>
            </div>
        </div>
    </div>

    <!-- Add Staff Modal -->
    <div class="modal-overlay" id="add-staff-modal" role="dialog" aria-labelledby="addStaffTitle" aria-hidden="true">
        <div class="modal-card">
            <div class="modal-header">
                <h2 id="addStaffTitle">Add Staff Member</h2>
                <button class="modal-close" data-close-modal aria-label="Close modal">&times;</button>
            </div>

            <div class="modal-body">
                <!-- Error/Success Messages -->
                <div id="addStaffError" class="modal-error" style="display: none;"></div>
                <div id="addStaffSuccess" class="modal-success" style="display: none;"></div>

                <form id="addStaffForm">
                    <div class="modal-grid">
                        <!-- Full Name (Required) -->
                        <div class="field">
                            <label for="staffName">Full Name *</label>
                            <input type="text"
                                    id="staffName"
                                    name="name"
                                    placeholder="e.g. Sara Johnson"
                                    required>
                        </div>

                        <!-- Email (Required) -->
                        <div class="field">
                            <label for="staffEmail">Email *</label>
                            <input type="email"
                                    id="staffEmail"
                                    name="email"
                                    placeholder="sarah.j@gymflow.com"
                                    required>
                        </div>

                        <!-- Phone (Required) -->
                        <div class="field">
                            <label for="staffPhone">Phone *</label>
                            <input type="tel"
                                    id="staffPhone"
                                    name="phone"
                                    placeholder="(416) 555-0101"
                                    required>
                        </div>

                        <!-- Emergency Contact (Optional) -->
                        <div class="field">
                            <label for="staffEmergencyContact">Emergency Contact</label>
                            <input type="text"
                                    id="staffEmergencyContact"
                                    name="emergency_contact"
                                    placeholder="e.g. Mike Johnson">
                        </div>

                        <!-- Emergency Phone -->
                        <div class="field">
                            <label for="staffEmergencyPhone">Emergency Phone</label>
                            <input type="tel"
                                    id="staffEmergencyPhone"
                                    name="emergency_phone"
                                    placeholder="(416) 555-0199">
                        </div>

                        <!-- Role (Required) -->
                        <div class="field">
                            <label for="staffRole">Role *</label>
                            <select id="staffRole" name="role" required>
                                <option value="">Select role...</option>
                                <option value="Front Desk CSR">Front Desk CSR</option>
                                <option value="Sales">Sales</option>
                                <option value="Operations">Operations</option>
                                <option value="Manager">Manager</option>
                                <option value="Admin">Admin</option>
                            </select>
                        </div>

                        <!-- Location (Required) - Populated by JavaScript -->
                        <div class="field">
                            <label for="staffLocationSelect">Location *</label>
                            <select id="staffLocationSelect" name="location_id" required>
                                <option value="">Select location...</option>
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>

                        <!-- Hire Date (Required) -->
                        <div class="field">
                            <label for="staffHireDate">Hire Date *</label>
                            <input type="date"
                                    id="staffHireDate"
                                    name="hire_date"
                                    required>
                        </div>

                        <!-- Hourly Rate (Optional) -->
                        <div class="field">
                            <label for="staffHourlyRate">Hourly Rate ($)</label>
                            <input type="number"
                                    id="staffHourlyRate"
                                    name="hourly_rate"
                                    placeholder="e.g. 22.50"
                                    step="0.01"
                                    min="0">
                        </div>
                    </div>

                    <!-- Notes (Optional) -->
                    <div class="field">
                        <label for="staffNotes">Notes</label>
                        <textarea id="staffNotes"
                                    name="notes"
                                    rows="3"
                                    placeholder="Certifications, languages, special skills, etc."></textarea>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            <div class="modal-footer">
                <button class="btn ghost" data-close-modal type="button">Cancel</button>
                <button class="btn primary" type="submit" form="addStaffForm" id="submitAddStaff">
                    <i class="fa-solid fa-plus"></i>
                        Add Staff Member
                </button>
            </div>
        </div>
    </div>


    <!-- ============================================
         CHECK-IN NOTIFICATION CONTAINER
         Displays success notifications when members check in
         ============================================ -->

    <div id="checkInNotifications" class="check-in-notifications"></div>


    <!-- ============================================
         JAVASCRIPT FILES (Load at end for performance)
         ============================================ -->
    <!-- Chart.js library (for charts) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
    
    <!-- Shared JS: Used by all admin pages -->
    <script src="../js/main.js"></script>
    <script src="../js/sidebar.js"></script>
    <script src="../js/modals.js"></script>
    <script src="../js/shared.js"></script>
    
    <!-- Dashboard-specific JS: Mock data & dashboard logic -->
    <script src="../js/pages/admin-dashboard.js"></script>
</body>
</html>